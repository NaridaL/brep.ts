<!DOCTYPE html>
<html>
	<head>
		<title>NCAD</title>
		<meta charset="UTF-8">
		<script type="text/javascript" src="node_modules/chroma-js/chroma.js"></script>
		<script type="text/javascript" src="lib/toSource.js"></script>
		<script type="text/javascript" src="lib/opentype.js"></script>
		<script type="text/javascript" src="lib/SVGPathData.js"></script>

		<script type="text/javascript" src="out/src/NLA.js"></script>
		<script type="text/javascript" src="out/src/CustomSet.js"></script>
		<script type="text/javascript" src="out/src/Transformable.js"></script>
		<script type="text/javascript" src="out/src/Vector.js"></script>
		<script type="text/javascript" src="out/src/Vector3.js"></script>
		<script type="text/javascript" src="out/src/Line.js"></script>
		<script type="text/javascript" src="out/src/Matrix.js"></script>
		<script type="text/javascript" src="out/src/Matrix4x4.js"></script>
		<script type="text/javascript" src="out/src/AABB.js"></script>
		<script type="text/javascript" src="out/src/Plane3.js"></script>

		<script type="text/javascript" src="out/src/curve/Curve.js"></script>
		<script type="text/javascript" src="out/src/curve/Line3.js"></script>
		<script type="text/javascript" src="out/src/curve/PICurve.js"></script>
		<script type="text/javascript" src="out/src/curve/PPCurve.js"></script>
		<script type="text/javascript" src="out/src/curve/BezierCurve.js"></script>
		<script type="text/javascript" src="out/src/curve/SemiEllipseCurve.js"></script>
		<script type="text/javascript" src="out/src/curve/EllipseCurve.js"></script>
		<script type="text/javascript" src="out/src/curve/ParabolaCurve.js"></script>
		<script type="text/javascript" src="out/src/curve/HyperbolaCurve.js"></script>

		<script type="text/javascript" src="out/src/surface/Surface.js"></script>
		<script type="text/javascript" src="out/src/surface/PlaneSurface.js"></script>
		<script type="text/javascript" src="out/src/surface/ConicSurface.js"></script>
		<script type="text/javascript" src="out/src/surface/ProjectedCurveSurface.js"></script>
		<script type="text/javascript" src="out/src/surface/SemiCylinderSurface.js"></script>
		<script type="text/javascript" src="out/src/surface/CylinderSurface.js"></script>
		<script type="text/javascript" src="out/src/surface/EllipsoidSurface.js"></script>
		<script type="text/javascript" src="out/src/surface/SemiEllipsoidSurface.js"></script>

		<script type="text/javascript" src="out/src/Edge.js"></script>
		<script type="text/javascript" src="out/src/Face.js"></script>
		<script type="text/javascript" src="out/src/FaceInfo.js"></script>
		<script type="text/javascript" src="out/src/B2.js"></script>
		<script type="text/javascript" src="out/src/b2.generators.js"></script>

		<script type="text/javascript" src="lib/MooTools-Core-1.6.0.js"></script>
		<script type="text/javascript" src="lib/MooTools-More-1.6.0.js"></script>
		<script type="text/javascript" src="out/src/lightgl.js"></script>
		<script type="text/javascript" src="out/src/CustomPlane.js"></script>
		<script type="text/javascript" src="out/src/editor.js"></script>
		<script type="text/javascript" src="out/src/modes.js"></script>
		<script type="text/javascript" src="out/src/SketchBezier.js"></script>
		<script type="text/javascript" src="lib/earcut.dev.js"></script>


		<script type="text/javascript" src="lib/MooTools-Core-1.6.0.js"></script>
		<script type="text/javascript" src="out/src/lightgl.js"></script>
		<script type="text/javascript" src="out/src/shaders.js"></script>

		<script type="text/javascript" src="out/src/Sketch.js"></script>
		<!--<script type="text/javascript" src="lib/function-plot@1.17.0.js"></script>-->

		<script id="template" type="x-template">
            <div>
	            <span style="width: 10em; display: inline-block; text-transform: uppercase">$what</span>
	            $name <a href="#" class="unsel icon-link">U</a>
	            <a href="#" class="featureDelete icon-link remove" name="delete">&#x274C;</a></div>
        </script>
		<script id="templateConstraint" type="x-template">
            <div>
	            $name
	            <a href="#" class="featureDelete icon-link remove">&#x274C;</a></div>
        </script>
		<script id="templateDistance" type="x-template">
            <div>$name <input class="distanceInput" type="text" id="distanceInput$id" />
            <a href="#" class="featureDelete icon-link remove">&#x274C;</a>
            </div>
        </script>
		<script id="templateAngle" type="x-template">
            <div>$name
	            <input class="distanceInput" type="text" id="distanceInput$id" />
	            <a href="#" class="fa">FA</a>
	            <a href="#" class="fb">FB</a>
	            <a href="#" class="fv">FV</a>
	            <a href="#" class="featureDelete icon-link remove">&#x274C;</a></div>
        </script>
		<script id="templateConstraintSub" type="x-template">
			<div>
				<span style="width: 10em; display: inline-block; text-transform: uppercase">$what</span>
				$name <a href="#" class="removeFromConstraint">Free</a></div>
		</script>
		<script id="templateFeatureExtrude" type="x-template">
			<div class="feature">
				<span style="width: 42px; display: inline-block">$what</span>
				<span style="width: 105px; display: inline-block;color: purple;">$name</span>
				<a class="featureDelete icon-link" name="delete" data-tooltip="Delete feature. Dependent features will fail to build and will need to be modified.">&#x274C;</a>
				<a class="featureEdit icon-link" name="edit" data-tooltip="Modify this feature.">&#x1f589;</a>
                <a class="featureHide icon-link" name="toggleHide" data-tooltip="Temporarily prevent this feature from being built. Dependent features will not be built.">&#x1f441;</a>
                <a class="icon-link" name="rollBack" data-tooltip="Rollback feature.">R</a>
				<span style="cursor:help; display:none; color:red; font-weight: bold" name="error">âš </span></div>
		</script>

		<style type="text/css">
			* {
				box-sizing: border-box;
			}
			body {
				font-family: Verdana,sans-serif;
				padding: 0;
				margin:0;
			}
			.selector {
				border: 1px solid black;
				cursor: pointer;
				display: inline-block;
				width: 10em;
			}
			.selecting {
				border-color: darkred;
				color: darkgreen;
			}
			.icon-link {
				text-decoration: none;
				color: darkred;
			}

			.editorBox {
				background: #eeeeee;
				padding: 4px;
				display: none;
				margin: 8px;
			}
			.editorBox .header {
				font-weight: bold;
			}
			label {
				display: block;
			}
			label span {
				display: inline-block;
				width: 7em;
			}
			.featureHide.hidden {
				text-decoration: line-through;
				color: darkgrey;
			}


			.rebuildLimit {
				font-size: smaller;
				background-color: #de7c58;
				text-align: center;
			}
			.isDependedOn {
				background-color: #9fde60;
			}
			.hasDependents {
				background-color: #8dc3de;
			}

			#tip-wrap {
				z-index: 3000;
			}
			#tip {
				position: relative;
				color: #fcffd2;
				min-width: 128px;
				max-width: 256px;
				padding: 8px;
				background: #5cee8a;
				font-size: small;
			}

			#tip-arrow
			{
				position: absolute;
				border-style: solid;
				border-color: #5cee8a transparent;
				display: block;
				width: 0;
				z-index: 1;
				top: -8px;
				left: 16px;
			}

			#buttonbar {
				background-color: #8f8e93;
				font-size: 0;
			}
			#buttonbar button {
				background-color: transparent;
				color: white;
				border: none;
				line-height: 2.5em;
				font-size: 12pt;
				margin: 0;
				padding: 0 0.5em;
			}
			#buttonbar button:hover {
				/*border-bottom: 4px solid white;*/
				background-color: #4354ed;
				cursor: pointer;
			}
			#buttonbar button:disabled {
				background-color: #bbbabf;
				color: #d9d8de;
				display: none;
				cursor: not-allowed;
			}
			#featureDisplay.selectable .feature {
				cursor: pointer;
			}
			#featureDisplay.selectable .feature:hover, #featureDisplay.selectable .feature.selected {
				background-color: mediumvioletred;
			}

		</style>
	</head>
	<body>
	<canvas id="textTextureCanvas" style="display: none;top: 80px; left: 8px; z-index: 1000" width="64" height="64"></canvas>
	<div id="interface" style="z-index: 1000">
		<div id="buttonbar">
			<button type="button" onclick="clicky()">Step</button>
			<button type="button" onclick="exportModel()">STL</button>
			<button type="button" id="clearmode">Pop Mode</button>
			<button type="button" id="rebuild" onclick="rebuildModel();">rebuild</button>
			<button type="button" onclick="modePush(MODES.SKETCH)" data-tooltip="Add a new 2D sketch at the current position in the feature stack.">+ Sketch</button>
			<button type="button" onclick="modePush(MODES.PATTERN)" data-tooltip="Repeat an existing feature linearly in one or more directions.">+ Pattern</button>
			<button type="button" onclick="modePush(MODES.PLANE_DEFINITION)" data-tooltip="Define a new plane, for example through three points.">+ Plane</button>
			<button type="button" onclick="modePush(MODES.EXTRUDE)"
			        data-tooltip="Add a new extrusion at the current position in the feature stack. Extrude a sketched loop, then remove or add it from the existing volume.">+ Extrude</button>
			<button type="button" class="sketchControl" onclick="modePush(MODES.ADD_SEGMENT, SketchLineSeg);" data-tooltip="Add one or more line segments to the current sketch. Middle-click when done.">+ Line Seg</button>
			<button type="button" class="sketchControl" onclick="modePush(MODES.ADD_SEGMENT, SketchArc);" data-tooltip="Add one or more circular arcs to the current sketch. Middle-click when done.">+ Arc</button>
			<button type="button" class="sketchControl" onclick="modePush(MODES.ADD_SEGMENT, SketchBezier);">+ Bezier</button>
			<button type="button" class="sketchControl" onclick="modePush(MODES.ADD_POINTS);">+ Points</button>
			<button type="button" class="sketchControl" onclick="makeGroup('parallel');">Parallel</button>
			<button type="button" class="sketchControl" onclick="makePerpendicular();">Perpendicular</button>
			<button type="button" class="sketchControl" onclick="makeGroup('equalLength');">Equal Length</button>
			<button type="button" class="sketchControl" onclick="makeSelCoincident();">Coincident</button>
			<button type="button" class="sketchControl" onclick="selPointOnLine();">Point on Line</button>
			<button type="button" class="sketchControl" onclick="makeGroup('colinear');">Colinear</button>
			<button type="button" class="sketchControl" onclick="makeDistance()">Distance</button>
			<button type="button" class="sketchControl" onclick="makeAngle();">Angle</button>
			<button type="button" class="sketchControl" onclick="faceSketchPlane();">Face Sketch Plane</button>
		</div>
		<div id="editors" style="float: right; margin: 8px; width: 200px;">
			<div id="sketchEditor" class="editorBox">
				Edit Sketch
				<input type="text" data-feature-property="name" id="sketchEditorSketchName" class="string-id-input" />
				<label><span>On Plane</span>
					<span id="sketchEditorPlaneName" class="plane-select selector" data-feature-property="planeRef">nbsp;</span></label>

				<button name="done">Done</button>
				<button name="delete">Delete</button>
			</div>

			<div id="selectedStuff" class="editorBox" style="display: block;">
				<span class="header">Elements</span>
				<div id="selectedElements"></div>
				<span class="header">Constraints</span>
				<div id="selectedConstraints"></div>
			</div>

			<div id="saveLoad" class="editorBox" style="display: block;">
				<div>
					<input type="text" id="saveNameInput" />
					<button id="saveButton">Save</button>
				</div>
				<select id="loadSelect">
					<option>Choose save to load</option>
				</select>
			</div>
			<div id="modeBox" class="editorBox" style="display: block;">
			</div>


			<div id="planeDefiner" class="editorBox">
				<span class="header">Define Plane</span>
				<input type="text" id="planeDefinerPlaneId" class="string-id-input" data-feature-property="planeId"/>
				<select name="planeType" class="select-select">
					<option value="face">Face</option>
					<option value="points">Through Points</option>
					<option value="anchorNormal">Anchor & Normal</option>
					<option value="immediate">Immediate</option>
				</select>
				<div>
					<span>Select face</span>
					<label data-tooltip="Angle blah blub" title="ARFHAKJ"><span>Offset</span>
						<input class="dimension-input" data-default-value="0" data-feature-property="offset" /></label>
					<label><span>Angle</span>
						<input class="dimension-input" data-default-value="0" data-feature-property="angle" /></label>
					<label><span>Flip</span>
						<input class="boolean-input" data-default-value="false" data-feature-property="flipped" type="checkbox" /></label>


				</div>
				<div>
					Input
					<input class="select-text" name="source" />
				</div>
				<button name="done">Done</button>
				<button name="delete">Delete</button>
			</div>

			<div id="extrudeEditor" class="editorBox">
				<span class="header">Extrude</span>
				<input type="text" data-feature-property="name" class="string-id-input" />
				<label>
					<span>Select Loop</span>
					<div class="segment-select selector" data-feature-property="segmentName">&nbsp;</div></label>
				<label><span>Start</span> <input type="text" class="dimension-input" data-feature-property="start" data-default-value="0" /></label>
				<label><span>End</span> <input type="text" class="dimension-input" data-feature-property="end" data-default-value="0" /></label>
				<select data-feature-property="operation" class="select-select">
					<option value="minus">Difference</option>
					<option value="plus">Union</option>
					<option value="and">Intersection</option>
				</select>
				<button name="done">Done</button>
				<button name="delete">Delete</button>
			</div>

			<div id="patternEditor" class="editorBox">
				<span class="header">Extrude</span>
				<input type="text" data-feature-property="name" class="string-id-input" />
				<label>
					<span>Feature</span>
					<span class="feature-select selector" data-feature-property="feature">sel feat</span></label>
				<label>
					<span>Direction</span>
					<span class="direction-select selector" data-feature-property="direction">sel dir</span></label>
				<label><span>Flip</span>
					<input class="boolean-input" data-default-value="false" data-feature-property="directionFlipped" type="checkbox" /></label>
				<label><span>Count</span> <input type="text" class="dimension-input" data-feature-property="count" data-default-value="0" /></label>
				<label><span>Total</span>
					<input type="text" class="dimension-input" data-feature-property="totalLength" data-default-value="0" /></label>
				<label><span>Interval</span> <input type="text" class="dimension-input" data-feature-property="intervalLength" data-default-value="0" /></label>
				<button name="done">Done</button>
				<button name="delete">Delete</button>
			</div>
		</div>
		<div id="featureDisplay"
		     style="background:#eeeeee; padding:4px; margin: 8px; width: 256px;">
			TEEEST</div></div>
	<canvas id="mainCanvas"
	        style="display:block;position: absolute; left: 0px; right: 0px; top: 2em; bottom: 0px;width: 100%;z-index: -100"></canvas>

	<div id="tip-wrap" style="position: absolute;z-index: 6000; left: 100px; top:100px; color:red;">
		<div id="tip">This should be visitble.</div>
		<div id="tip-arrow"></div>
	</div>
	</body>
</html>